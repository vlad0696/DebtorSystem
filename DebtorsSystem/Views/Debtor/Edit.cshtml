@model DebtorsSystem.Models.Debtor;
@{
    ViewData["Title"] = "Edit";
    DateTime dateTime = new DateTime(1, 1, 1);
    string DateIssue="";
    if (Model.DateIssue.ToShortDateString() != "01.01.0001")
    {
        DateIssue = @Model.DateIssue.ToShortDateString();
    }
     string DateWorkStarted="";
    if (Model.DateWorkStarted.ToShortDateString() != "01.01.0001")
    {
        DateWorkStarted = @Model.DateWorkStarted.ToShortDateString();
    }
     string DateWorkStopped="";
    if (Model.DateWorkStopped.ToShortDateString() != "01.01.0001")
    {
        DateWorkStopped = @Model.DateWorkStopped.ToShortDateString();
    }
     string DateRefund="";
    if (Model.DateRefund.ToShortDateString() != "01.01.0001")
    {
        DateRefund = @Model.DateRefund.ToShortDateString();
    }
     string DateTrial="";
    if (Model.DateTrial.ToShortDateString() != "01.01.0001")
    {
        DateTrial = @Model.DateTrial.ToShortDateString();
    }
     string DateResumptionExecution="";
    if (Model.DateResumptionExecution.ToShortDateString() != "01.01.0001")
    {
        DateResumptionExecution = @Model.DateResumptionExecution.ToShortDateString();
    }
     string DateExecution="";
    if (Model.DateExecution.ToShortDateString() != "01.01.0001")
    {
        DateExecution = @Model.DateExecution.ToShortDateString();
    }
    
}
<script src="~/js/jquery-3.3.1.min.js"></script>
<script src="~/js/semantic.min.js"></script>
<script src="~/js/dropdown.min.js"></script>
<script src="~/js/calendar.min.js"></script>
<link href="~/css/semantic.css" rel="stylesheet" type="text/css" />
<link href="~/css/dropdown.min.css" rel="stylesheet" type="text/css" />
<link href="~/css/calendar.min.css" rel="stylesheet" type="text/css" />
<h2>Edit</h2>
<div id="mainform" style=" margin-left:5%; margin-right:5%">
    <form class="ui form" id="debtorAddForm" onsubmit="return false;">

        <input name="Id" type="hidden" value="@Model.Id">
        <div class=" field">
            <label>ФИО</label>
            <input name="FIO" type="text" placeholder="ФИО" value="@Model.FIO">
        </div>

        <div class="field">
            <label>Дата выпуска</label>
            <input type="text" placeholder="Дата выпуска" name="DateIssue" value="@DateIssue">
        </div>
        <div class=" field">
            <label>Уровень подготовки</label>
            <div class="ui selection dropdown" style="margin-top:1%;margin-bottom:1% ">

                <input type="hidden" name="TrainingLevel" value="@Model.TrainingLevel">
                <i class="dropdown icon"></i>
                <div class="default text">Уровень подготовки</div>
                <div class="menu">
                    <div class="item" data-value="1">ПТО</div>
                    <div class="item" data-value="0">ССО</div>
                </div>
            </div>
        </div>
        <div class=" field">
            <label>Адрес</label>
            <input type="text" placeholder="Адрес" name="Address" value="@Model.Address">
        </div>

        <div class="field">
            <label>Дата прибытия на работу</label>
            <input type="text" placeholder="Дата прибытия на работу" name="DateWorkStarted" value="@DateWorkStarted">
        </div>

        <div class="field">
            <label>Дата увольнения</label>
            <input type="text" placeholder="Дата увольнения" name="DateWorkStopped" value="@DateWorkStopped">
        </div>

        <div class="field">
            <label>Дата уведомления</label>
            <input type="text" placeholder="Дата уведомления" name="DateRefund" value="@DateRefund">
        </div>

        <div class=" field">
            <label>Сумма возмещения</label>
            <input type="text" placeholder="Сумма возмещения" name="RefundAmount" value="@Model.RefundAmount">
        </div>

        <div class=" field">
            <label>Сумма возмещения до суда</label>
            <input type="text" placeholder="Сумма возмещения до суда" name="RefundBeforeTrial" value="@Model.RefundBeforeTrial">
        </div>

        <div class="field">
            <label>Дата суда</label>
            <input type="text" placeholder="Дата суда" name="DateTrial" value="@DateTrial">
        </div>

        <div class=" field">
            <label>Сумма, возмещённая после суда</label>
            <input type="text" placeholder="Сумма возмещения после суда" name="RefundAfterTrial" value="@Model.RefundAfterTrial">
        </div>

        <div class="field">
            <label>Дата остановки исполнительного производства</label>
            <input type="text" placeholder="Дата остановки исполнительного производства" name="DateExecution" value="@DateExecution">
        </div>

        <div class="field">
            <label>Дата восстановления исполнительного производства</label>
            <input type="text" placeholder="Дата восстановления исполнительного производства" name="DateResumptionExecution" value="@DateResumptionExecution">
        </div>

        <div class="field">
            <label>Переписка</label>
            <textarea style="margin-top: 0px; margin-bottom: 0px; height: 112px;" name="Mails">@Model.Mails</textarea>
        </div>

        <div id="addButton" class="ui submit button">Сохранить</div>
        <div class="ui error message"></div>

    </form>
</div>
<script>
    $('#DateIssue, #DateRefund, #DateTrial, #DateExecution, #DateWorkStarted, #DateWorkStopped, #DateResumptionExecution').calendar({
        type: 'date',
        firstDayOfWeek: 1,
        formatInput: false,
        text: {
            days: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],
            months: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],
            monthsShort: ['Янв', 'Фев', 'Март', 'Апр', 'Май', 'Июнь', 'Июль', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'],
            today: 'Сегодня'
        },
    });
    $('.ui.dropdown')
        .dropdown();


    var $debtorAddForm = $('#debtorAddForm');
    $('#mainform .ui.button').on('click', function () {
        if ($debtorAddForm.form('is valid')) {
            $mydata = {
                'Id': $debtorAddForm.form('get value', 'Id'),
                'FIO': $debtorAddForm.form('get value', 'FIO'),
                'DateIssue': $debtorAddForm.form('get value', 'DateIssue'),
                'TrainingLevel': $debtorAddForm.form('get value', 'TrainingLevel'),
                'Address': $debtorAddForm.form('get value', 'Address'),
                'DateWorkStarted': $debtorAddForm.form('get value', 'DateWorkStarted'),
                'DateWorkStopped': $debtorAddForm.form('get value', 'DateWorkStopped'),
                'RefundAmount': $debtorAddForm.form('get value', 'RefundAmount'),
                'DateRefund': $debtorAddForm.form('get value', 'DateRefund'),
                'RefundBeforeTrial': $debtorAddForm.form('get value', 'RefundBeforeTrial'),
                'DateTrial': $debtorAddForm.form('get value', 'DateTrial'),
                'RefundAfterTrial': $debtorAddForm.form('get value', 'RefundAfterTrial'),
                'DateExecution': $debtorAddForm.form('get value', 'DateExecution'),
                'DateResumptionExecution': $debtorAddForm.form('get value', 'DateResumptionExecution'),
                'Mails': $debtorAddForm.form('get value', 'Mails')
            }
            console.log($mydata);
            $.ajax({
                url: '/debtor/Edit',
                type: 'POST',
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify($mydata),
                success: function (data) {
                    window.location = "@Url.Action("Index", "Debtor")";

                },
                async: true
            });
        }
    })

      $('.ui.form')
        .form({
            on: 'blur',
            fields: {
                FIO: {
                    identifier: 'FIO',
                    rules: [{
                        type: 'empty',
                        prompt: 'Введите ФИО'
                    }]
                },
                RefundAmount: {
                    identifier: 'RefundAmount',
                    rules: [{
                        type: 'regExp',
                        value: /^[0-9]{1,5},?[0-9]{1,5}$/i,
                        prompt: 'Сумма возмещения введена некорректно! Введите сумму в через запятую: "134,76"'
                    }]
                },
                RefundBeforeTrial: {
                    identifier: 'RefundBeforeTrial',
                    optional: true,
                    rules: [{
                        type: 'regExp',
                        value: /^[0-9]{1,5},?[0-9]{1,5}$/i,
                        prompt: 'Сумма возмещения до суда введена некорректно! Введите сумму в через запятую: "134,76"'
                    }]
                },
                RefundAfterTrial: {
                    identifier: 'RefundAfterTrial',
                    optional: true,
                    rules: [{
                        type: 'regExp',
                        value: /^[0-9]{1,5},?[0-9]{1,5}$/i,
                        prompt: 'Сумма возмещения после суда введена некорректно! Введите сумму в через запятую: "134,76"'
                    }]
                },
                TrainingLevel: {
                    identifier: 'TrainingLevel',
                    rules: [{
                        type: 'empty',
                        prompt: 'Введите уровень подготовки'
                    }]
                },
                Address: {
                    identifier: 'Address',
                    rules: [{
                        type: 'empty',
                        prompt: 'Введите адрес'
                    }]
                },
                DateIssue: {
                    identifier: 'DateIssue',
                    rules: [{
                        type: 'regExp',
                        value: /^\d{1,2}[.]\d{1,2}[.]\d{4}$/g,
                        prompt: 'Дата выпуска введена некорректно! Введите дату в формате "дд/мм/гггг" ("03.05.2019")'
                    }
                    ],
                },
                DateWorkStarted: {
                    identifier: 'DateWorkStarted',
                    optional: true,
                    rules: [{
                        type: 'regExp',
                        value: /^\d{1,2}[.]\d{1,2}[.]\d{4}$/g,
                        prompt: 'Дата приступления к работе введена некорректно! Введите дату в формате "дд/мм/гггг" ("03.05.2019")'
                    }]
                },
                DateWorkStopped: {
                    identifier: 'DateWorkStopped',
                    optional: true,
                    rules: [{
                        type: 'regExp',
                        value: /^\d{1,2}[.]\d{1,2}[.]\d{4}$/g,
                        prompt: 'Дата увольнения введена некорректно! Введите дату в формате "дд/мм/гггг" ("03.05.2019")'
                    }]
                },
                DateRefund: {
                    identifier: 'DateRefund',
                    rules: [{
                        type: 'regExp',
                        value: /^\d{1,2}[.]\d{1,2}[.]\d{4}$/g,
                        prompt: 'Дата уведомления введена некорректно! Введите дату в формате "дд/мм/гггг" ("03.05.2019")'
                    }]
                },
                DateTrial: {
                    identifier: 'DateTrial',
                    optional: true,

                    rules: [{
                        type: 'regExp',
                        value: /^\d{1,2}[.]\d{1,2}[.]\d{4}$/g,
                        prompt: 'Дата суда введена некорректно! Введите дату в формате "дд/мм/гггг" ("03.05.2019")'
                    }]
                },
                DateExecution: {
                    identifier: 'DateExecution',
                    optional: true,

                    rules: [{
                        type: 'regExp',
                        value: /^\d{1,2}[.]\d{1,2}[.]\d{4}$/g,
                        prompt: 'Дата остановки исполнительного производства введена некорректно! Введите дату в формате "дд/мм/гггг" ("03.05.2019")'
                    }]
                },
                DateResumptionExecution: {
                    identifier: 'DateResumptionExecution',
                    optional: true,

                    rules: [{
                        type: 'regExp',
                        value: /^\d{1,2}[.]\d{1,2}[.]\d{4}$/g,
                        prompt: 'Дата восстановления исполнительного производства введена некорректно! Введите дату в формате "дд/мм/гггг" ("03.05.2019")'
                    }]
                }
            }
        })

</script>